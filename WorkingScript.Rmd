---
title: "Working script"
output: pdf_document
date: "2025-11-04"
---



```{r}
library(dplyr)
library(glmnet)
library(Metrics)
library(tidymodels)

# For testing
data_2025 <- read.csv("Data/2025baseballdata.csv")

# For training
data_2024 <- read.csv("Data/2024bbdata.csv")
data_2023 <- read.csv("Data/2023bbdata.csv")
data_2022 <- read.csv("Data/2022bbdata.csv")
data_2021 <- read.csv("Data/2021bbdata.csv")
data_2020 <- read.csv("Data/2020bbdata.csv")

data_2020 <- data_2020 |> select(-c("Awards", "Pos", "Team", "Lg") )
data_2021 <- data_2021 |> select(-c("Awards", "Pos", "Team", "Lg") )
data_2022 <- data_2022 |> select(-c("Awards", "Pos", "Team", "Lg") )
data_2023 <- data_2023 |> select(-c("Awards", "Pos", "Team", "Lg") )
data_2024 <- data_2024 |> select(-c("Awards", "Pos", "Team", "Lg") )

data_2020$year <- 2020
data_2021$year <- 2021
data_2022$year <- 2022
data_2023$year <- 2023
data_2024$year <- 2024

training_data <- rbind(data_2024, data_2023, data_2022, data_2021, data_2020)

training_data <- training_data |> 
  arrange(Player, year ) |>
  group_by(Player) |>
  mutate(WAR_next = lead(WAR, 1)) |>
  ungroup()

training_data <- training_data |> filter(!is.na(WAR_next))

training_data_clean <- training_data |>
  select(-Player, -year)

ols_spec <- linear_reg() |>
  set_engine("lm")

ols_fit <- ols_spec |>
  fit(WAR_next ~ ., data = training_data_clean)

summary(ols_fit$fit)

set.seed(445)
data_split <- initial_split(training_data_clean, prop = 0.8)
train <- training(data_split)
test <- testing(data_split)

ols_fit <- ols_spec |>
  fit(WAR_next ~., data = train)

preds <- predict(ols_fit, test) |> bind_cols(test)

rmse(preds, truth = WAR_next, estimate = .pred)
mae(preds, truth = WAR_next, estimate = .pred)
```

```{r}
```




